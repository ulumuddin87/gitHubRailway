<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>Rapot Semester {{ semester|default('') }}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { font-family: 'Calibri', sans-serif; line-height: 1.6; }
        .kop-surat { text-align: center; margin-bottom: 20px; }
        .kop-surat hr { border: 2px solid black; }
        .rapot-title { text-align: center; margin: 20px 0; }
        .table th, .table td { vertical-align: middle; }
        .table-section { background-color: #f8f9fa; font-weight: bold; }
    </style>
</head>
<body class="bg-light">

<div class="container py-4">

    <!-- Kop Surat -->
    <div class="kop-surat">
        <h4 class="mb-0"><b>TAMAN PENDIDIKAN AL-QUR'AN</b></h4>
        <h2 class="mb-0"><b>“MAFATIHUL HUDA”</b></h2>
        <p class="mb-0">Desa Bakalanrayung Kecamatan Kudu Kabupaten Jombang Provinsi Jawa Timur</p>
        <p class="mb-0">Nomor Statistik : 411.235.17.2074 | Telp. 0857-3634-0726</p>
        <hr>
    </div>

    <!-- Judul Rapot -->
    <div class="rapot-title">
        <h3><b>LAPORAN HASIL BELAJAR</b></h3>
        <h5>Semester {{ semester|default('-') }}</h5>
    </div>

    <!-- Data Murid -->
    <div class="mb-4">
        <p><strong>Nama Peserta Didik :</strong> {{ murid.nama|default('-') }}</p>
        <p><strong>Kelas :</strong> {{ murid.kelas|default('-') }}</p>
        <p><strong>Wali Kelas :</strong> {{ murid.wali_kelas|default('-') }}</p>
        <p><strong>Tanggal Cetak :</strong> {{ now.strftime("%d-%m-%Y") }}</p>
    </div>

    <!-- Tabel Nilai -->
    <table class="table table-bordered">
        <thead class="table-dark">
            <tr>
                <th style="width:30%;">Mata Pelajaran</th>
                <th style="width:10%;">Nilai</th>
                <th>Deskripsi</th>
            </tr>
        </thead>
        <tbody>
        {% if nilai_list and nilai_list|length > 0 %}
            {% set current_group = None %}
            {% for n in nilai_list %}
                {% if current_group != n.kelompok %}
                    <tr class="table-section">
                        <td colspan="3">{{ n.kelompok|default('LAINNYA') }}</td>
                    </tr>
                    {% set current_group = n.kelompok %}
                {% endif %}
                <tr>
                    <td>{{ n.mapel|default('-') }}</td>
                    <td class="text-center">{{ n.nilai|default('-') }}</td>
                    <td>{{ n.deskripsi|default(n.diskripsi|default('-')) }}</td>
                </tr>
            {% endfor %}
        {% else %}
            <tr>
                <td colspan="3" class="text-center text-muted">Belum ada nilai</td>
            </tr>
        {% endif %}
        </tbody>
    </table>

    <!-- Tanda Tangan -->
    <div class="row text-center mt-5">
        <div class="col">
            <p><b>Kepala Madrasah</b></p>
            <br><br><br>
            <p>( Ustadz Ahmad )</p>
        </div>
        <div class="col">
            <p><b>Wali Kelas</b></p>
            <br><br><br>
            <p>( {{ murid.wali_kelas|default('-') }} )</p>
        </div>
        <div class="col">
            <p><b>Peserta Didik</b></p>
            <br><br><br>
            <p>( {{ murid.nama|default('-') }} )</p>
        </div>
    </div>

    <!-- Tombol -->
    <div class="mt-4 text-center">
        <a href="{{ url_for('rapot_pdf', murid_id=murid.id, semester=semester) }}" class="btn btn-success">
            Download PDF
        </a>
        <a href="{{ url_for('data_murid') }}" class="btn btn-secondary">Kembali</a>
    </div>

</div>
</body>
</html>
