{% extends 'base.html' %}
{% block title %}Nilai Murid{% endblock %}
{% block content %}

<div class="card shadow-sm">
  <div class="card-header bg-success text-white">
    <h5 class="mb-0">Nilai Murid - Jilid {{ jilid }}</h5>
  </div>
  <div class="card-body">
    <ul>
      <li><b>Nama:</b> {{ murid.nama }}</li>
      <li><b>Kelas:</b> {{ murid.kelas }}</li>
      <li><b>Jilid Aktif:</b> {{ murid.jilid }}</li>
      <li><b>Wali Kelas:</b> {{ murid.wali_kelas}}</li>
    </ul>

    <h5 class="mt-4">ğŸ“– Riwayat Nilai</h5>
<div class="table-responsive">
  <table class="table table-bordered table-striped align-middle text-center">
    <thead class="table-light">
      <tr>
        <th>Jilid</th>
        <th>Mapel</th>
        <th>Nilai</th>
        <th>Tanggal</th>
      </tr>
    </thead>
    <tbody>
      {% for n in riwayat %}
      <tr>
        <td>{{ n.jilid }}</td>
        <td>{{ n.mapel }}</td>
        <td>{{ n.nilai }}</td>
        <td>{{ n.created_at.strftime("%d-%m-%Y") }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>



<form method="POST">
  <div class="row g-3">
    {% for m in mapel_list %}
    <div class="col-md-6">
      <label class="form-label">Nilai {{ m.nama }}</label>
      <input type="number" name="mapel_{{ m.id }}" class="form-control">
    </div>
    {% endfor %}
  </div>

  <div class="d-flex justify-content-between mt-3">
    <a href="{{ url_for('data_murid') }}" class="btn btn-secondary">â¬… Kembali</a>
    <div>
      <button type="submit" name="action" value="simpan" class="btn btn-warning">ğŸ’¾ Simpan Sementara</button>
      <button type="submit" name="action" value="upload" class="btn btn-success">â¬†ï¸ Upload Nilai</button>
    </div>
  </div>
</form>



<!-- âœ… SweetAlert2 CDN -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
  document.getElementById('nilaiForm').addEventListener('submit', function(event) {
    event.preventDefault(); // stop dulu submit otomatis

    Swal.fire({
      title: 'Apakah nilai sudah benar?',
      icon: 'question',
      showCancelButton: true,
      confirmButtonText: 'âœ… Ya, Simpan',
      cancelButtonText: 'âŒ Belum',
      reverseButtons: true
    }).then((result) => {
      if (result.isConfirmed) {
        this.submit(); // baru kirim form kalau pilih Ya
      }
    });
  });
</script>

{% endblock %}
